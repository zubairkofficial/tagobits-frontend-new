import{r,j as e,$ as R,a0 as W,a1 as T,a2 as h,a3 as n}from"./index-AihZuQYH.js";const C=()=>{const[l,o]=r.useState({title:"",description:"",youtube_url:"",wistia_url:""}),[j,g]=r.useState([]),[S,v]=r.useState(!0),[N,b]=r.useState(null),[F,u]=r.useState(!1),[i,m]=r.useState(null),[U,f]=r.useState(null),[d,k]=r.useState(null),[c,y]=r.useState(!1),A=t=>{if(!t)return null;const s=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/,a=t.match(s);return a&&a[7].length===11?a[7]:null},$=t=>{if(!t)return"";const s=t.match(/wistia\.com\/embed\/(?:medias\/)?([^/?]+?)(?:\.js)?$/);return s?`https://fast.wistia.net/embed/iframe/${s[1]}`:""},_=t=>{if(t.youtube_url){const s=A(t.youtube_url);return s?`https://www.youtube.com/embed/${s}`:""}return t.wistia_url?$(t.wistia_url):""},w=async()=>{try{v(!0),b(null);const t=await h.get("/use-case");console.log("Use Cases API Response:",t.data),t.data&&Array.isArray(t.data)?g(t.data):(console.error("Invalid response format:",t.data),g([]))}catch(t){if(console.error("Error fetching Use Cases:",t),b("Failed to fetch Use Cases"),t&&typeof t=="object"&&"response"in t){const s=t;s.response&&(console.error("Error response:",s.response.data),b(`Failed to fetch Use Cases: ${s.response.data?.detail||s.response.statusText||"Unknown error"}`))}g([])}finally{v(!1)}};r.useEffect(()=>{w()},[]);const x=t=>{const{name:s,value:a}=t.target;o(p=>({...p,[s]:a}))},I=async t=>{if(t.preventDefault(),y(!0),!l.youtube_url&&!l.wistia_url){n.error("Please provide either a YouTube URL or Wistia URL"),y(!1);return}const a={...l,wistia_url:(p=>{if(!p)return"";const E=p.trim().match(/([A-Za-z0-9]{8,})$/),L=E?E[1]:"";return L?`https://fast.wistia.com/embed/medias/${L}`:""})(l.wistia_url)};try{i?.id?(await h.put(`/use-case/${i.id}`,a),n.success("Use Case updated successfully")):(await h.post("/use-case",a),n.success("Use Case created successfully")),o({title:"",description:"",youtube_url:"",wistia_url:""}),m(null),u(!1),w()}catch{n.error(i?"Failed to update Use Case":"Failed to create Use Case")}finally{y(!1)}},D=t=>{m(t),o(t),u(!0),f(null)},M=async t=>{try{k(t),await h.delete(`/use-case/${t}`),n.success("Use Case deleted successfully"),w(),f(null)}catch{n.error("Failed to delete Use Case")}finally{k(null)}};return S?e.jsx(R,{}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-4 sm:p-8",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 sm:gap-0 mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 text-center sm:text-left",children:"Use Case Management"}),e.jsxs("button",{onClick:()=>{m(null),o({title:"",description:"",youtube_url:"",wistia_url:""}),u(!0)},className:"flex items-center justify-center gap-2 bg-gradient-to-r from-[#1952A8] to-primary-dark text-white px-6 py-3 rounded-lg hover:opacity-90 transition duration-200 shadow-md",children:[e.jsx(W,{className:"text-sm"}),e.jsx("span",{children:"Upload Video"})]})]}),N&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:N}),e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:j.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"No Use Cases available"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Video Preview"}),e.jsx("th",{className:"px-6 py-4 text-right text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:j.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.title}),e.jsx("td",{className:"px-6 py-4 text-gray-600",children:t.description.length>100?`${t.description.substring(0,100)}...`:t.description}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"w-[200px] h-[120px]",children:_(t)?e.jsx("iframe",{src:_(t),title:t.title,className:"w-full h-full rounded-lg",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 rounded-lg text-gray-500 text-sm",children:t.youtube_url||t.wistia_url?"Invalid Video URL":"No Video URL"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>f(U===t.id?null:t.id||null),className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",children:e.jsx(T,{className:"text-gray-600"})}),U===t.id&&e.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-10 transform transition-all duration-200 origin-top-right scale-100",children:e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:()=>D(t),disabled:d===t.id,className:`w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center gap-2 ${d===t.id?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]}),e.jsx("button",{onClick:()=>t.id&&M(t.id),disabled:d===t.id,className:`w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors duration-200 flex items-center gap-2 ${d===t.id?"opacity-50 cursor-not-allowed":""}`,children:d===t.id?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-red-600 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Deleting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})})]})})]})})]},t.id))})]})})})]}),F&&e.jsx("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center z-50 transition-all duration-300 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl transform transition-all duration-300 scale-100",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:i?"Edit Use Case":"Upload New Video"}),e.jsxs("form",{onSubmit:I,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),e.jsx("input",{type:"text",id:"title",name:"title",value:l.title,onChange:x,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1952A8] focus:border-transparent",placeholder:"Enter title",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{id:"description",name:"description",value:l.description,onChange:x,rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1952A8] focus:border-transparent",placeholder:"Enter description",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"youtube_url",className:"block text-sm font-medium text-gray-700 mb-1",children:"YouTube Link (Optional)"}),e.jsx("input",{type:"url",id:"youtube_url",name:"youtube_url",value:l.youtube_url,onChange:x,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1952A8] focus:border-transparent",placeholder:"Enter YouTube video link"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"wistia_url",className:"block text-sm font-medium text-gray-700 mb-1",children:"Wistia Link (Optional)"}),e.jsx("input",{type:"url",id:"wistia_url",name:"wistia_url",value:l.wistia_url,onChange:x,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1952A8] focus:border-transparent",placeholder:"Enter Wistia video link"})]}),e.jsxs("div",{className:"text-sm text-gray-600 bg-blue-50 p-3 rounded-lg",children:[e.jsx("p",{className:"font-medium mb-1",children:"Note:"}),e.jsx("p",{children:"Please provide either a YouTube URL or Wistia URL (or both). At least one video URL is required."})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{type:"button",onClick:()=>{u(!1),m(null),o({title:"",description:"",youtube_url:"",wistia_url:""})},disabled:c,className:`px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 ${c?"opacity-50 cursor-not-allowed":""}`,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:c,className:`bg-gradient-to-r from-[#1952A8] to-primary-dark text-white px-6 py-3 rounded-lg hover:opacity-90 transition duration-200 ${c?"opacity-50 cursor-not-allowed":""}`,children:c?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:i?"Updating...":"Uploading..."})]}):e.jsx("span",{children:i?"Update":"Upload"})})]})]})]})})]})};export{C as default};
