import{r as d,a2 as N,j as e,$ as A,a4 as C,a5 as L,a6 as k,a3 as o}from"./index-AihZuQYH.js";const F=()=>{const[s,c]=d.useState(""),[i,h]=d.useState(""),[v,x]=d.useState(!0),[m,f]=d.useState(!1),[y,u]=d.useState(null),[T,b]=d.useState("");d.useEffect(()=>{j()},[]);const j=async()=>{try{x(!0);const a=await N.get("/app-timer");if(a.data.success){const r=new Date(a.data.data.launch_date).toISOString().slice(0,16);c(r),h(r);const t=new Date(a.data.data.updated_at);b(t.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}))}else u("Failed to load App Timer")}catch(a){a.response&&a.response.status===404?(u("No App Timer found. You can create a new one."),h("")):(u("Failed to load App Timer. Please try again later."),console.error("Error fetching app timer:",a))}finally{x(!1)}},S=async()=>{if(!s.trim()){o.error("Launch date cannot be empty");return}try{f(!0);const a=i==="",t=await N[a?"post":"put"]("/app-timer",{launch_date:new Date(s).toISOString()});if(t.data.success){let l=a?"App Timer created successfully":"App Timer updated successfully";t.data.knowledge_base==="updated"?l+=" (Knowledge base updated)":t.data.knowledge_base==="not_updated"&&(l+=" (Knowledge base not updated)",t.data.knowledge_base_error&&console.warn("Knowledge base update failed:",t.data.knowledge_base_error)),o.success(l),h(s),u(null);const g=new Date(t.data.data.updated_at);b(g.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}))}else o.error(t.data.detail||"Failed to update App Timer")}catch(a){console.error("Error updating app timer:",a),o.error(a.response?.data?.detail||"An error occurred while updating App Timer")}finally{f(!1)}},D=()=>{c(i===""?"":i),o.success("Changes discarded")},p=i!==s,n=i==="";return v?e.jsx("div",{className:"h-screen flex items-center justify-center",children:e.jsx(A,{})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:n?"Create App Timer":"Manage App Timer"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:D,disabled:!p||m,className:`flex items-center gap-2 px-4 py-2 rounded-md ${p?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:[e.jsx(C,{})," Discard Changes"]}),e.jsx("button",{onClick:S,disabled:!p||m,className:`flex items-center gap-2 px-4 py-2 rounded-md ${p&&!m?"bg-gradient-to-r from-[#1952A8] to-primary-dark text-white hover:opacity-90":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:m?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loader",style:{width:"16px",height:"16px"}}),n?"Creating...":"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(L,{})," ",n?"Create Timer":"Save Changes"]})})]})]}),y&&!n?e.jsxs("div",{className:"bg-red-50 text-red-700 p-4 rounded-md mb-6",children:[y,e.jsx("button",{onClick:j,className:"ml-2 text-red-700 hover:text-red-900 underline",children:"Try Again"})]}):e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:n?"Create New App Timer":"Edit App Timer"}),!n&&e.jsxs("span",{className:"text-sm text-gray-500",children:["Last Updated: ",T]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded mb-6 text-sm text-gray-600",children:[e.jsx("p",{className:"font-semibold mb-1",children:"App Timer Information:"}),e.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[e.jsx("li",{children:"This date will be used for the countdown timer on the Download App page"}),e.jsx("li",{children:"The countdown will show days, hours, minutes, and seconds until this date"}),e.jsxs("li",{children:[`Changes won't be saved until you click "`,n?"Create Timer":"Save Changes",'"']})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"launchDate",className:"block text-sm font-medium text-gray-700 mb-2",children:"App Launch Date & Time"}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"datetime-local",id:"launchDate",value:s,onChange:a=>c(a.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-dark focus:border-transparent",placeholder:"Select launch date and time"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"This will be the target date for the countdown timer on the mobile app download page."})]}),s&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-md",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Preview:"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Selected date: ",e.jsx("span",{className:"font-medium",children:new Date(s).toLocaleString()})]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Time until launch: ",e.jsx("span",{className:"font-medium",children:(()=>{const a=new Date,r=new Date(s).getTime()-a.getTime();if(r<=0)return"Launch date has passed";const t=Math.floor(r/(1e3*60*60*24)),l=Math.floor(r/(1e3*60*60)%24),g=Math.floor(r/(1e3*60)%60);return`${t} days, ${l} hours, ${g} minutes`})()})]})]})]})]})]})};export{F as default};
