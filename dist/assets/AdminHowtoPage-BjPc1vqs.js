import{r as s,j as e,$ as A,a0 as D,a1 as I,a2 as h,a3 as n}from"./index-B9ijupVs.js";const W=()=>{const[r,o]=s.useState({title:"",description:"",youtube_url:"",wistia_url:""}),[b,H]=s.useState([]),[L,w]=s.useState(!0),[j,v]=s.useState(null),[C,u]=s.useState(!1),[l,m]=s.useState(null),[N,g]=s.useState(null),[d,k]=s.useState(null),[c,f]=s.useState(!1),_=t=>{if(!t)return null;const i=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/,a=t.match(i);return a&&a[7].length===11?a[7]:null},y=async()=>{try{w(!0);const t=await h.get("/how-to");H(t.data),v(null)}catch{v("Failed to fetch How to")}finally{w(!1)}};s.useEffect(()=>{y()},[]);const x=t=>{const{name:i,value:a}=t.target;o(p=>({...p,[i]:a}))},$=async t=>{t.preventDefault(),f(!0);try{if(!r.youtube_url&&!r.wistia_url){n.error("Please provide either a YouTube URL or Wistia URL"),f(!1);return}const a={...r,wistia_url:(p=>{if(!p)return"";const S=p.trim().match(/([A-Za-z0-9]{8,})$/),F=S?S[1]:"";return F?`https://fast.wistia.com/embed/medias/${F}.js`:""})(r.wistia_url)};l?.id?(await h.put(`/how-to/${l.id}`,a),n.success("How to updated successfully")):(await h.post("/how-to",a),n.success("How to created successfully")),o({title:"",description:"",youtube_url:"",wistia_url:""}),m(null),u(!1),y()}catch{n.error(l?"Failed to update How to":"Failed to create How to")}finally{f(!1)}},E=t=>{m(t),o(t),u(!0),g(null)},U=async t=>{try{k(t),await h.delete(`/how-to/${t}`),n.success("How to deleted successfully"),y(),g(null)}catch{n.error("Failed to delete How to")}finally{k(null)}};return L?e.jsx(A,{}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-4 sm:p-8",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 sm:gap-0 mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 text-center sm:text-left",children:"How to Guide Management"}),e.jsxs("button",{onClick:()=>{m(null),o({title:"",description:"",youtube_url:""}),u(!0)},className:"flex items-center justify-center gap-2 bg-gradient-to-r from-[#1952A8] to-primary-dark text-white px-6 py-3 rounded-lg hover:opacity-90 transition duration-200 shadow-md",children:[e.jsx(D,{className:"text-sm"}),e.jsx("span",{children:"Upload Video"})]})]}),j&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:j}),e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:b.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"No How to available"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Video Preview"}),e.jsx("th",{className:"px-6 py-4 text-right text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:b.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.title}),e.jsx("td",{className:"px-6 py-4 text-gray-600",children:t.description.length>100?`${t.description.substring(0,100)}...`:t.description}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"w-[200px] h-[120px]",children:t.youtube_url&&_(t.youtube_url)?e.jsx("iframe",{src:`https://www.youtube.com/embed/${_(t.youtube_url)}`,title:t.title,className:"w-full h-full rounded-lg",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}):t.wistia_url?e.jsx("iframe",{src:`https://fast.wistia.net/embed/iframe/${(t.wistia_url.match(/([A-Za-z0-9]{8,})$/)||["",""])[1]}`,title:t.title,className:"w-full h-full rounded-lg",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 rounded-lg text-gray-500 text-sm",children:"No Video URL"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>g(N===t.id?null:t.id||null),className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",children:e.jsx(I,{className:"text-gray-600"})}),N===t.id&&e.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-10 transform transition-all duration-200 origin-top-right scale-100",children:e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:()=>E(t),disabled:d===t.id,className:`w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center gap-2 ${d===t.id?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]}),e.jsx("button",{onClick:()=>t.id&&U(t.id),disabled:d===t.id,className:`w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors duration-200 flex items-center gap-2 ${d===t.id?"opacity-50 cursor-not-allowed":""}`,children:d===t.id?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-red-600 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Deleting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})})]})})]})})]},t.id))})]})})})]}),C&&e.jsx("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center z-50 transition-all duration-300 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl transform transition-all duration-300 scale-100",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:l?"Edit How to":"Upload New Video"}),e.jsxs("form",{onSubmit:$,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),e.jsx("input",{type:"text",id:"title",name:"title",value:r.title,onChange:x,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1952A8] focus:border-transparent",placeholder:"Enter title",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{id:"description",name:"description",value:r.description,onChange:x,rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1952A8] focus:border-transparent",placeholder:"Enter description",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"youtube_url",className:"block text-sm font-medium text-gray-700 mb-1",children:"YouTube Link (Optional)"}),e.jsx("input",{type:"url",id:"youtube_url",name:"youtube_url",value:r.youtube_url,onChange:x,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1952A8] focus:border-transparent",placeholder:"Enter YouTube video link"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"wistia_url",className:"block text-sm font-medium text-gray-700 mb-1",children:"Wistia Link (Optional)"}),e.jsx("input",{type:"text",id:"wistia_url",name:"wistia_url",value:r.wistia_url,onChange:x,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1952A8] focus:border-transparent",placeholder:"Paste any Wistia URL or ID (we'll normalize it)"})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{type:"button",onClick:()=>{u(!1),m(null),o({title:"",description:"",youtube_url:"",wistia_url:""})},disabled:c,className:`px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 ${c?"opacity-50 cursor-not-allowed":""}`,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:c,className:`bg-gradient-to-r from-[#1952A8] to-primary-dark text-white px-6 py-3 rounded-lg hover:opacity-90 transition duration-200 ${c?"opacity-50 cursor-not-allowed":""}`,children:c?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:l?"Updating...":"Uploading..."})]}):e.jsx("span",{children:l?"Update":"Upload"})})]})]})]})})]})};export{W as default};
